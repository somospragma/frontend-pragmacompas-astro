---
import BaseLayout from "@/components/templates/BaseLayout.astro";
import { getComments } from "@/infrastructure/services/comment/get-comments";
import type { Comment } from "@/shared/entities/comment";

const comments: Comment[] = await getComments();
---

<BaseLayout>
  <div class="container mx-auto p-4">
    <h1 class="text-3xl font-bold text-center mb-6">Comments</h1>

    {comments.length === 0 && <div class="text-center text-lg text-gray-500">No comments available.</div>}

    {
      comments.length !== 0 && (
        <div class="space-y-4">
          {comments.map((comment) => (
            <div class="bg-white shadow-md rounded-lg p-4">
              <div class="flex justify-between items-center mb-3">
                <div>
                  <span class="font-semibold text-gray-900">{comment.user}</span>
                  <span class="text-sm text-gray-600">({comment.username})</span>
                </div>
                <div>
                  <span class="text-sm text-gray-500">{new Date(comment.timestamp).toLocaleString()}</span>
                </div>
              </div>
              <p class="text-gray-700 mb-3">{comment.content}</p>
              {comment.isArchived && (
                <span class="inline-block bg-gray-300 text-gray-900 py-1 px-3 text-xs rounded-full">Archived</span>
              )}
            </div>
          ))}
        </div>
      )
    }
  </div>
</BaseLayout>
